<!-- Wappler include head-page="layouts/main" is="dmx-app" id="users" appConnect="local" jquery_slim_35="local" fontawesome_4="local" bootstrap4="cerulean" bootstrap_icons="cdn" components="{dmxBootstrap4TableGenerator:{},dmxDataTraversal:{},dmxBootstrap4Modal:{},dmxFormatter:{}}" -->
<div class="modal mt-5 pt-5" id="modal3" is="dmx-bs4-modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Adicionar usuário</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form id="register1" method="post" is="dmx-serverconnect-form" action="/api/security/registration" dmx-on:success="modal3.hide();serverconnect1.load({},true)">
          <div class="form-group row">
            <label for="inp_password" class="col-sm-2 col-form-label col-form-label-sm">Nome</label>
            <div class="col-sm-10">

              <input type="text" id="inp_first_name" name="first_name" class="form-control form-control-sm" placeholder="First Name" data-msg-required="">
            </div>
          </div>
          <div class="form-group row">
            <label for="inp_password" class="col-sm-2 col-form-label col-form-label-sm">Sobrenome</label>
            <div class="col-sm-10">

              <input type="text" id="inp_last_name" name="last_name" class="form-control form-control-sm" placeholder="Last Name">
            </div>
          </div>
          <div class="form-group row">
            <label for="inp_password" class="col-sm-2 col-form-label col-form-label-sm">Email</label>
            <div class="col-sm-10">

              <input type="email" id="inp_email" name="email" class="form-control form-control-sm" placeholder="Email" required="">
            </div>
          </div>
          <div class="form-group row">
            <label for="inp_password" class="col-sm-2 col-form-label col-form-label-sm">Senha</label>
            <div class="col-sm-10">

              <input type="password" id="inp_password" name="password" class="form-control form-control-sm" placeholder="Password" required="">
            </div>
          </div>
          <div class="form-group row">
            <label for="inp_password2" class="col-sm-2 col-form-label col-form-label-sm">Confirma</label>
            <div class="col-sm-10">

              <input type="password" id="inp_pass_confirm" name="pass_confirm" class="form-control form-control-sm" placeholder="Confirm Password" required="">
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" dmx-on:click="run({run:{action:`modal3.register1.submit()`}})">Incluir&nbsp;<i class="bi-plus-circle-fill"></i></button>
      </div>
    </div>
  </div>
</div>
<div class="modal" id="modal2" is="dmx-bs4-modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Trocar senha</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form id="form1" is="dmx-serverconnect-form" method="post" action="/api/security/update_password_adm">
          <input type="hidden" class="form-control" id="inp_email" name="email" aria-describedby="input1_help" placeholder="Enter some text">

          <div class="form-group row">
            <label for="inp_password" class="col-sm-2 col-form-label col-form-label-sm">Senha</label>
            <div class="col-sm-10">
              <input type="password" class="form-control" id="inp_password" name="password" aria-describedby="input1_help" placeholder="Enter some text">

            </div>
          </div>
          <div class="form-group row">
            <label for="inp_pass_confirm" class="col-sm-2 col-form-label col-form-label-sm">Confirmação</label>
            <div class="col-sm-10">
              <input type="password" class="form-control" id="inp_pass_confirm" name="pass_confirm" aria-describedby="input1_help" placeholder="Enter some text">
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" dmx-on:click="run({run:{action:`modal2.form1.submit();modal2.hide();serverconnect1.load({},true)`}})">Salvar</button>
      </div>
    </div>
  </div>
</div>
<div class="modal" id="modal1" is="dmx-bs4-modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Usuário</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form is="dmx-serverconnect-form" id="serverconnectform1" method="post" action="/api/users/mod" dmx-generator="bootstrap4" dmx-form-type="horizontal" dmx-populate="data_detail1.data"
          dmx-on:success="modal1.hide();serverconnect1.load({},true)">
          <input type="hidden" name="operation" id="inp_operation" dmx-bind:value="data_detail1.data.operation">
          <div class="form-group row">
            <label for="inp_first_name" class="col-sm-2 col-form-label col-form-label-sm">Nome</label>
            <div class="col-sm-10">
              <input type="text" class="form-control form-control-sm" id="inp_first_name" name="first_name" dmx-bind:value="data_detail1.data.first_name" aria-describedby="inp_first_name_help" placeholder="Enter First name">
            </div>
          </div>
          <div class="form-group row">
            <label for="inp_last_name" class="col-sm-2 col-form-label col-form-label-sm">Sobrenome</label>
            <div class="col-sm-10">
              <input type="text" class="form-control form-control-sm" id="inp_last_name" name="last_name" dmx-bind:value="data_detail1.data.last_name" aria-describedby="inp_last_name_help" placeholder="Enter Last name">
            </div>
          </div>
          <div class="form-group row">
            <label for="inp_email" class="col-sm-2 col-form-label col-form-label-sm">Email</label>
            <div class="col-sm-10">
              <input type="text" class="form-control form-control-sm" id="inp_email" name="email" dmx-bind:value="data_detail1.data.email" aria-describedby="inp_email_help" placeholder="Enter Email">
            </div>
          </div>
          <div class="form-group row">
            <label for="inp_document" class="col-sm-2 col-form-label col-form-label-sm">Document</label>
            <div class="col-sm-10">
              <input type="text" class="form-control form-control-sm" id="inp_document" name="document" dmx-bind:value="data_detail1.data.document" aria-describedby="inp_document_help" placeholder="Enter Document">
            </div>
          </div>
          <div class="form-group row">
            <label for="inp_role" class="col-sm-2 col-form-label col-form-label-sm">Role</label>
            <div class="col-sm-10">
              <input type="text" class="form-control form-control-sm" id="inp_role" name="role" dmx-bind:value="data_detail1.data.role" aria-describedby="inp_role_help" placeholder="Enter Role">
            </div>
          </div>
          <div class="form-group row">
            <label for="inp_did" class="col-sm-2 col-form-label col-form-label-sm">Did</label>
            <div class="col-sm-10">
              <input type="text" class="form-control form-control-sm" id="inp_did" name="did" dmx-bind:value="data_detail1.data.did" aria-describedby="inp_did_help" placeholder="Enter Did" readonly="true">
            </div>
          </div>
          <div class="form-group row">
            <label for="inp_verkey" class="col-sm-2 col-form-label col-form-label-sm">Verkey</label>
            <div class="col-sm-10">
              <input type="text" class="form-control form-control-sm" id="inp_verkey" name="verkey" dmx-bind:value="data_detail1.data.verkey" aria-describedby="inp_verkey_help" placeholder="Enter Verkey" readonly="true">
            </div>
          </div>
          <div class="form-group row">
            <label for="inp_pass_hash" class="col-sm-2 col-form-label col-form-label-sm">Hash</label>
            <div class="col-sm-10">
              <input type="text" class="form-control form-control-sm" id="inp_pass_hash" name="pass_hash" dmx-bind:value="data_detail1.data.pass_hash" aria-describedby="inp_pass_hash_help" placeholder="Enter Pass hash" readonly="true">
            </div>
          </div>
          <div class="form-group row">
            <label for="inp_pass_salt" class="col-sm-2 col-form-label col-form-label-sm">Salt</label>
            <div class="col-sm-10">
              <input type="text" class="form-control form-control-sm" id="inp_pass_salt" name="pass_salt" dmx-bind:value="data_detail1.data.pass_salt" aria-describedby="inp_pass_salt_help" placeholder="Enter Pass salt" readonly="true">
            </div>
          </div>
          <div class="form-group row">
            <label for="inp_token" class="col-sm-2 col-form-label col-form-label-sm">Token</label>
            <div class="col-sm-10">
              <input type="text" class="form-control form-control-sm" id="inp_token" name="token" dmx-bind:value="data_detail1.data.token" aria-describedby="inp_token_help" placeholder="Enter Token" readonly="true">
            </div>
          </div>
          <div class="form-group row">
            <label for="inp_wallet_id" class="col-sm-2 col-form-label col-form-label-sm">Wallet_id</label>
            <div class="col-sm-10">
              <input type="text" class="form-control form-control-sm" id="inp_wallet_id" name="wallet_id" dmx-bind:value="data_detail1.data.wallet_id" aria-describedby="inp_token_help" placeholder="Enter wallet_id" readonly="true">
            </div>
          </div>
          <input type="hidden" name="id" id="inp_id" dmx-bind:value="data_detail1.data.id">
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-sm btn-success" dmx-on:click="run({run:{action:`modal2.form1.inp_email.setValue(content.data_detail1.data.email);modal2.form1.reset();modal1.hide();modal2.show()`}})">Senha<i
            class="bi-key-fill"></i></button>
        <button type="button" class="btn btn-sm btn-danger" dmx-on:click="run([{run:{action:`modal1.serverconnectform1.inp_operation.setValue(\'delete\')`}},{run:{action:`modal1.serverconnectform1.submit()`}}])">Excluir<i
            class="bi-trash-fill"></i></button>
        <button type="button" class="btn btn-primary btn-sm"
          dmx-on:click="run([{condition:{if:`(content.data_detail1.data != null)`,then:{steps:{run:{action:`modal1.serverconnectform1.inp_operation.setValue(\'update\')`}}},else:{steps:{run:{action:`modal1.serverconnectform1.inp_operation.setValue(\'add\')`}}}}},{run:{action:`modal1.serverconnectform1.submit()`}}])">Salva&nbsp;<i
            class="bi-archive"></i></button>
      </div>
    </div>
  </div>
</div>
<dmx-data-detail id="data_detail1" dmx-bind:data="content.serverconnect1.data.query" key="id"></dmx-data-detail>
<dmx-serverconnect id="serverconnect1" url="/api/users/get"></dmx-serverconnect>



<div class="container-fluid mt-5">

  <h5 class="text-center h-auto pt-5"><i class="bi-person-circle"></i>&nbsp;Usuários</h5>
  <button id="btn1" class="btn btn-primary btn-sm font-weight-bold" dmx-on:click="modal3.register1.reset();modal3.show()">Adicionar&nbsp;&nbsp;
    <i class="fa fa-plus-circle fa-lg"></i>
  </button>

  <div class="table-responsive">
    <table class="table table-striped table-bordered table-hover table-sm">
      <thead>
        <tr>
          <th>First name</th>
          <th>Last name</th>
          <th>Email</th>
          <th>Document</th>
        </tr>
      </thead>
      <tbody is="dmx-repeat" dmx-generator="bs4table" dmx-bind:repeat="content.serverconnect1.data.query" id="tableRepeat1">
        <tr dmx-on:click="data_detail1.select(id);modal1.show()">
          <td dmx-text="first_name"></td>
          <td dmx-text="last_name"></td>
          <td dmx-text="email"></td>
          <td dmx-text="document"></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>